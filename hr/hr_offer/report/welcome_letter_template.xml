<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_welcome_letter_document">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="web.external_layout">
                    <t t-set="contract" t-value="doc.contract_id" />

                    <!-- Header variables -->
                    <t t-set="doc_title" t-value="'Welcome Letter'" />
                    <t t-set="doc_number" t-value="'OF/WW/HRGS/029'" />
                    <t t-set="issue_number" t-value="'1'" />

                    <div class="page"
                        style="font-family: 'Times New Roman'; font-size: 12px; line-height: 1.5; padding-left: 50px; padding-right: 50px;">

                        <div class="oe_structure" />

                        <div style="margin-top: 20px; text-align: right;">
                            <strong>Refe.No:</strong>
                            <span t-esc="doc.company_id._get_formatted_sequence('external')" />
                            <br />
                            <strong>Date:</strong>
                            <span t-esc="time.strftime('%d/%m/%Y')" />
                        </div>

                        <div style="margin-top: 20px;">
                            <strong>To: <t t-if="doc.gender == 'male'">Mr. </t>
                                <t t-if="doc.gender == 'female'">Ms. </t>
                                <span t-field="doc.name" />
                            </strong>
                        </div>

                        <div style="margin-top: 20px; text-align: center;">
                            <strong>
                                <u>Job Offer Letter</u>
                            </strong>
                        </div>

                        <div style="margin-top: 20px; margin-botton: 20px; text-align: justify;">
                            <p>Dear <t t-if="doc.gender == 'male'">Mr. </t>
                                <t t-if="doc.gender == 'female'">Ms. </t>
                                <!-- Using first name of the employee for a personal touch -->
                                <span t-esc="doc.name.split(' ')[0]" />, </p>

                            <!-- Check if a contract exists. If not, the salary/allowance details
                            will be hidden. -->
                            <t t-if="not contract">
                                <p class="alert alert-warning">
                                    <strong>Note:</strong> Contract details (salary, allowances) are
                                    not available as no contract is linked to this employee. </p>
                            </t>

                            <p> It is our pleasure to inform you that effective from May 28, 2025
                                you are employed as <strong>
                                    <span t-esc="doc.job_title or 'your new position'" />
                                </strong>
                                <t t-if="doc.parent_id"> under direct supervision of <strong>
                                        <span t-esc="doc.parent_id.job_title or doc.parent_id.name" />
                                    </strong>
                                </t>
                                . <t t-if="doc.address_id"> Your duty station will be at <strong>
                                        <span t-esc="doc.address_id.name" />
                                    </strong>
                                . </t>
                            </p>

                            <t t-if="contract">
                                <t t-set="all_allowances"
                                    t-value="[
                                    ('house_rent_allowance', 'House Rent Allowance'),
                                    ('dearness_allowance', 'Dearness Allowance'),
                                    ('travel_allowance', 'Travel Allowance'),
                                    ('meal_allowance', 'Meal Allowance'),
                                    ('medical_allowance', 'Medical Allowance'),
                                    ('position_allowance', 'Position Allowance'),
                                    ('transport_home_allowance', 'Transport (Home) Allowance'),
                                    ('transport_work_allowance', 'Transport (Work) Allowance'),
                                    ('fuel_allowance', 'Fuel Allowance'),
                                    ('cash_indemnity_allowance', 'Cash Indemnity Allowance'),
                                    ('professional_allowance', 'Professional Allowance'),
                                    ('other_allowance', 'Other Allowance')
                                ]" />
                                <t t-set="active_allowances"
                                    t-value="[al for al in all_allowances if contract[al[0]] &gt; 0]" />

                                <p> Your monthly basic salary is Birr <strong>
                                        <span t-esc="contract.wage"
                                            t-options="{'widget': 'monetary', 'display_currency': doc.company_id.currency_id}" />
                                    (<span
                                            t-esc="doc.company_id.currency_id.amount_to_text(contract.wage)" />
                                    )</strong>. On top of that, you are entitled to get the
                                    following benefits. </p>

                                <t t-if="active_allowances">
                                    <ol style='padding-left: 50px; padding-right: 20px; margin-top: 10px; '>
                                        <t t-foreach="active_allowances" t-as="allowance">
                                            <t t-set="allowance_amount"
                                                t-value="contract[allowance[0]]" />
                                            <li>
                                                <strong><t t-esc="allowance[1]" /> of Birr <span
                                                        t-esc="allowance_amount"
                                                        t-options="{'widget': 'monetary', 'display_currency': doc.company_id.currency_id}" />
                                                    (<span
                                                        t-esc="doc.company_id.currency_id.amount_to_text(allowance_amount)" />
                                                    ) </strong>
                                            </li>
                                        </t>
                                    </ol>
                                </t>
                            </t>

                            <p>
                                The appointment is a permanent, full time position, subject to the
                                satisfactory completion of 60 working days probationary period.
                            </p>

                            <p>
                                We have attached here with employment contract and job description
                                for your reference. You are there by challenged to perform your
                                duties and responsibilities with care and love for work and quality
                                in performance.
                            </p>

                            <p>
                                The management of the company welcomes you with open arms and hopes
                                that you will guide the organization to higher levels of prosperity.
                            </p>

                            <div style="margin-top: 40px;">
                                <p>
                                    Yours sincerely,
                                </p>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>
