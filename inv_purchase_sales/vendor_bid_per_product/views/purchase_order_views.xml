<odoo>
    <record id="view_purchase_order_form_inherit" model="ir.ui.view">
        <field name="name">purchase.order.form.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='currency_id']" position="after">
                <field name='repeated_order' readonly="1" invisible="not repeated_order" />
            </xpath>

            <xpath expr="//field[@name='order_line']/list/field[@name='product_id']"
                position='attributes'>
                <attribute name="readonly">(repeated_order == True) or (state in ('purchase', 'to approve', 'done', 'cancel')) or (is_downpayment)</attribute>
            </xpath>

            <xpath expr="//field[@name='order_line']/list/field[@name='price_unit']"
                position='attributes'>
                <attribute name="readonly">(repeated_order == True) or (qty_invoiced != 0)</attribute>
            </xpath>

            <xpath expr="//field[@name='order_line']/list/field[@name='product_uom']"
                position='attributes'>
                <attribute name="readonly">(repeated_order == True) or (state in ('purchase', 'to approve', 'done', 'cancel')) or (is_downpayment)</attribute>
            </xpath>

        </field>
    </record>


    <record id="action_reorder_purchase_order" model="ir.actions.server">
        <field name="name">Repeat Order</field>
        <field name="model_id" ref="purchase.model_purchase_order" />
        <field name="binding_model_id" ref="purchase.model_purchase_order" />
        <field name="state">code</field>
        <field name="code">
# Odoo automatically provides the selected 'records'
if records:
    action = records[0].action_reorder()
        </field>
    </record>


</odoo>